<?xml version="1.0" encoding="UTF-8"?>
<project name="metadata" basedir="." xmlns:sf="antlib:com.salesforce">

   <property environment="env"/>
	<property file="CISupport/Sandbox/taskExecution.properties"/>
	<property name="property.file.path" value="CISupport/Sandbox/Sandbox_default.properties"/>
	<property file="CISupport/Sandbox/Sandbox_default.properties"/>

	<!-- checkSoftwareVersions macrodef-->
	<macrodef name="checkSoftwareVersions" description="Check all software versions that are required for devops cicd process">
		<sequential>
			<echo message="Check All Software Version on this Machine ${line.separator} -------------------------------------------"/>

			<exec executable="cmd" errorproperty="error" resultproperty="result" outputproperty="output" failonerror="true">
				<arg line='/c ant -version &amp;'/>
				<arg line='git --version &amp;'/>
				<arg line='sf --version &amp;'/>
				<arg line='java --version &amp;'/>
				<arg line='pmd --version'/>
			</exec>
			<echo message="Error property value : ${error}"/>
			<echo message="Result property value : ${result}"/>
			<echo message="Output property value :${line.separator}${output}"/>
		</sequential>
    </macrodef>


   <target name="start">
		<sequential>
			<!--call macrodef - checkSoftwareVersions-->
			<checkSoftwareVersions/>

			<!--call the target : startCICD in the build file : build_authorization.xml-->
			<ant antfile="build_authorization.xml" target="startCICD" useNativeBasedir="true">
				<property file="${property.file.path}"/>		
			</ant>	
		</sequential>
	</target>
</project>